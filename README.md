**Тестовое задание Укрпочта**

Данное задание на позицию Java-программиста.

*Использовать при решении : Java 8, Hibernate, H2, JPA, Maven.*

---

## Задача

Сделать небольшой REST-сервис с использованием Spring.

Суть сервиса: покупка товаров с помощью API данного сервиса. 

У нас есть три главные сущности: клиент(точнее его аккаунт), товар и скидки. Для этих сущностей предлагаю создать таблицы и использовать какую-нибудь in-memory базу данных, например,H2.

Конкретное количество полей в каждой таблице, связи между таблицами, и вообще, их количество- на Ваше усмотрение. И подчеркну, что я только описываю сам базис, который должен быть реализован. Полная свобода действий в реализации и добавление новых деталей. Например, список всех товаров разделить на категории.

**Должны быть реализованы как минимум такие энд-поинты:**

Передача и ответы запросов : предлагаю формат Json. Можете реализовывать другой                       

1. **/create_user** 
2. **/add_money** – добавить денег на аккаунт, тут в запросе должен быть указан id, name юзера которому они зачислятся .
3. **/list** – список товаров, добавления параметра Категория
4. **/pay** – купить товары ( должен быть параметр указания id товаров который хотим купить, id того кто покупает, что бы проверить хватает ли у него средств и снять для успешного завершения операции покупки).

| Овощи Vegetables(6) | Мясные продукты  Meat(5)  | Фрукты Fruits(6) | Крупы Cereals(4)
|---------------------|---------------------|--------------------------|------------------|
| Potato — картошка   | Bacon — бекон       | Apple — яблоко           | Buckwheat — гречка |
| Tomato — помидоры   | Beef  — говядина    | Apricot — абрикос        | Grain — зерно |
| Beans  — бобы       | Chicken — курица    | Banana — банан           | Pearl barley — перловая крупа |
| Broccoli — брокколи | Duck — утка         | Blackberry — ежевика     | Rice — рис |
| Cabbage — капуста   | Turkey — индейка    | Blueberry — черника      |            | 
| Carrot — морковь    |                     | Cherry — вишня           |            | 

В таблице скидок будут скидки на отдельные товары.                                                                                          
В запросе /pay надо рассчитать сумму всех товаром с учетом скидок на них.

| Овощи Vegetables(6)  | Мясные продукты  Meat(5)  | Фрукты Fruits(6) | Крупы Cereals(4)
|-------------------------|------------------------|-----------------------------|------------------|
| 16.Potato — картошка 7% | 5.Bacon — бекон 10%    | 10.Apple — яблоко 7%        | 1.Buckwheat — гречка 10% |
| 17.Tomato — помидоры 0% | 6.Beef  — говядина 9%  | 11.Apricot — абрикос 0%     | 2.Grain — зерно 15% |
| 18.Beans  — бобы 10%    | 7.Chicken — курица 7%  | 12.Banana — банан 10%       | 3.Pearl barley — перловая крупа 5% |
| 19.Broccoli — брокколи 30% | 8.Duck — утка 0%    | 13.Blackberry — ежевика 10% | 4.Rice — рис 7% |
| 20.Cabbage — капуста 0% | 9.Turkey — индейка 5%  | 14.Blueberry — черника 15%  |            | 
| 21.Carrot — морковь 0%  |                        | 15.Cherry — вишня 0%        |            | 

Если есть опыт FRONT-ENDa, можете сделать дополнительно минимальный интерфейс, снова повторюсь, инструмент на ваш выбор. Это как доп.задание, запрос-ответ в виде Json устроит.

*Дополнительно сделайте такой механизм –при покупке товаров, если товаров со скидками больше чем  3, то использовать в расчете суммы тольке те 3 скидки которые наиболее выгодны покупателю. Больше 3 товаров со скидками имееться в виду 3 разных товара, а не 3 экземпляра одного.

В расчете самых выгодных, учитывать количество одинаковых товаров.

Если есть понимание, что такое JPA реализуйте с ним. Для сборки -Maven.

---

## SQL


**2** Существует таблица с данными, в которой существуют повторяющиеся строки по значениям некоторых столбцов. 
Необходимо получить список повторяющихся строк. 
Потом удалить повторяющиеся строки, оставив только по одной уникальной строке (оставить только самые поздние строки). 
По возможности, **привести несколько вариантов решений.**

| EMPLOYEES |            |           |          | DEPARTMENT  
|-----------|------------|-----------|          |---------------|-----------------|
| LAST_NAME | DEPARTMENT | SALARY    |          | DEPARTMENT_ID | DEPARTMENT_NAME |
| Getz      | 10         | 3000      |          | 10            | Sales           |
| Davis     | 20         | 1500      |          | 20            | Marketing       |
| King      | 20         | 2200      |          | 30            | Accounts        |
| Davis     | 30         | 5000      |          | 40            | Administration  |
| Kochhar   |            | 5000      |          |               |                 |


**3** -Получить всех сотрудников, независимо от того, имеют ли они соответствия отдела в
департаменте
      -Вывести среднюю зарплату по отделам.

**4** Описание таблицы EMPLOYEES

EMP_ID NUMBER(4) NOT NULL
LAST_NAME VARCHAR2(30) NOT NULL
FIRST_NAME VARCHAR2(30)
DEPT_ID NUMBER(2)
JOB_CAT VARCHAR2(30)
SALARY NUMBER

Надо выбрать идентификатор отдела, минимальный размер заработной платы, а также максимальную зарплату, выплаченную в этом отделе, с учетом, что минимальная заработная плата составляет менее 5000, и максимальная зарплата больше, чем 15000?

**5** 

| EMPLOYEES   |          |         |        |          |        |       | DEPARTMENTS    |
|-------------|----------|---------|--------|----------|--------|       |----------------|------------------|
| EMPLOYEE_ID | EMP_NAME | DEPT_ID | MGR_ID | JOB_ID   | SALARY |       | DEPARTMENTS_ID | DEPARTMENTS_NAME |
| 101         | Smith    | 20      | 120    | SA_REP   | 4000   |       | 10             | Admin            |
| 102         | Martin   | 10      | 105    | CLERK    | 2500   |       | 20             | Education        |
| 103         | Chris    | 20      | 120    | IT_ADMIN | 4200   |       | 30             | IT               |
| 104         | John     | 30      | 108    | HR_CLERK | 2500   |       | 40             | Human Resources  |
| 105         | Diana    | 30      | 108    | IT_ADMIN | 5000   |       |                |                  |
| 106         | Smith    | 40      | 110    | AD_ASST  | 3000   |       |                |                  |
| 108         | Jennifer | 30      | 110    | HR_DIR   | 6500   |       |                |                  |
| 110         | Bob      | 40      |        | EX_DIR   | 8000   |       |                |                  |
| 120         | Ravi     | 20      | 110    | SA*DIR   | 6500   |       |                |                  |

- В таблице EMPLOYEES, EMPLOYEE_ID является первичным ключом.
MGR_ID это идентификатор менеджеров и относится к EMPLOYEE_ID.
Dept_id является внешним ключом к DEPARTMENT_ID колонке таблицы DEPARTMENTS.
В таблице DEPARTMENTS, department_id является первичным ключом. 
Что произойдет, если выполнить команды и почему?
  
  DELETE
  FROM departments
  WHERE department id = 40;

- В таблице EMPLOYEES, EMPLOYEE_ID является первичным ключом.
MGR_ID это идентификатор менеджеров и относится к EMPLOYEE_ID. 
Колонка JOB_ID - NOT NULL.
Что произойдет, если выполнить и почему?

  DELETE employee_id, salary, job_id
  FROM employees
  WHERE dept_id = 90;
